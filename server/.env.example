# ============================================
# MSIA 服务器环境变量配置
# 医学生智能问诊辅助系统
# ============================================

# ============================================
# 服务器配置
# ============================================
PORT=4000
HOST=0.0.0.0
NODE_ENV=development

# ============================================
# 数据库配置（必需）
# ============================================
# 连接字符串格式: postgresql://用户名:密码@主机:端口/数据库名?schema=public
# 生产环境请使用强密码
DATABASE_URL="postgresql://postgres:YOUR_DB_PASSWORD@localhost:5432/MSIA?schema=public"

DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=YOUR_DB_PASSWORD
DB_NAME=MSIA
DB_POOL_MAX=20
DB_POOL_MIN=5
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=10000

# ============================================
# JWT 安全配置（生产环境必需）
# ============================================
# 生成方式: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# 生产环境必须配置，建议 32 位以上随机字符串
JWT_SECRET="YOUR_JWT_SECRET_HERE_MIN_64_CHARS"

# ============================================
# 开发测试 Token 配置
# ============================================
# 仅开发环境生效，设置为 true 可使用 dev-admin / dev-doctor 测试 Token
# 生产环境请勿设置此变量或设置为 false
ENABLE_DEV_TOKENS=false

# ============================================
# Redis 配置（可选）
# ============================================
REDIS_URL=redis://localhost:6379

# ============================================
# 缓存配置
# ============================================
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# ============================================
# 安全配置
# ============================================
# 数据加密密钥（32 位字符）
ENCRYPTION_KEY=YOUR_32_CHAR_SECRET_KEY_HERE

# 登录失败锁定配置
LOGIN_MAX_FAILS_DOCTOR=5
LOGIN_MAX_FAILS_ADMIN=3
LOGIN_LOCK_MS_DOCTOR=300000
LOGIN_LOCK_MS_ADMIN=600000

# CORS 白名单（多个用逗号分隔）
ALLOWED_ORIGINS=http://localhost:8000,http://localhost:8100

# ============================================
# 数据库监控配置
# ============================================
DB_SLOW_QUERY_THRESHOLD=1000
DB_HEALTH_CHECK_INTERVAL=30000

# ============================================
# 告警配置（可选）
# ============================================
ALERT_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
ALERT_FROM=alert@msia.com
ALERT_TO=admin@msia.com
ALERT_LEVEL=error
ALERT_THROTTLE=300000

# ============================================
# 日志配置
# ============================================
LOG_LEVEL=info
ENABLE_DEBUG_LOGS=false

# ============================================
# 前端配置
# ============================================
VITE_PWA_ENABLED=true
VITE_API_URL=http://localhost:4000

# 推送通知配置（可选）
VITE_VAPID_PUBLIC_KEY=your-vapid-public-key
